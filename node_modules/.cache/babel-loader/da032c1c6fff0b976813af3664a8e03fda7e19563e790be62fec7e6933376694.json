{"ast":null,"code":"import{format,isToday,isYesterday,parseISO}from'date-fns';import React,{useCallback,useEffect,useRef,useState}from'react';import{useAuth}from'../../contexts/AuthContext';import{Controller,useForm}from'react-hook-form';import useWebSocket from'../../api';import{Col,Row}from'antd';import emojiRegex from'emoji-regex';import EmojiPicker from'emoji-picker-react';import{useNavigate}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ChatArea=_ref=>{let{selectedUser,api}=_ref;const{isAuthenticated,isServersConnected,setConnect}=useAuth();const{control,handleSubmit,reset,watch,setValue}=useForm();const navigate=useNavigate();const[messages,setMessages]=useState([]);const webScoket1=useWebSocket(process.env.REACT_APP_API_URL1);const webScoket2=useWebSocket(process.env.REACT_APP_API_URL2);const messagesEndRef=useRef(null);const[isScrolledUp,setIsScrolledUp]=useState(false);const[showEmojiPicker,setShowEmojiPicker]=useState(false);const msgToSend=watch(\"msgToSend\",\"\");// Limita o tamanho da mensagem e envia\nconst handleSendMessage=data=>{const maxLength=85;const message=data.msgToSend.slice(0,maxLength);// Limita o tamanho da mensagem\nif(!message)return;if(!webScoket1.checkConnection()){webScoket1.connectWebSocket();}if(!webScoket2.checkConnection()){webScoket2.connectWebSocket();}if(!webScoket1.checkConnection()&&!webScoket2.checkConnection()&&isServersConnected){setConnect(false);}else if((webScoket1.checkConnection()||webScoket2.checkConnection())&&!isServersConnected){setConnect(true);}webScoket1.send(\"/sendMessage \".concat(isAuthenticated,\" \").concat(selectedUser,\" \").concat(message));webScoket2.send(\"/sendMessage \".concat(isAuthenticated,\" \").concat(selectedUser,\" \").concat(message));reset();};const openNotificationWithIcon=useCallback((type,message,description)=>{api[type]({message,description});},[api]);useEffect(()=>{const interval=setInterval(()=>{if(!isAuthenticated){navigate('/');}if(!webScoket1.checkConnection()){webScoket1.connectWebSocket();}if(!webScoket2.checkConnection()){webScoket2.connectWebSocket();}if(!webScoket1.checkConnection()&&!webScoket2.checkConnection()&&isServersConnected){setConnect(false);}else if((webScoket1.checkConnection()||webScoket2.checkConnection())&&!isServersConnected){setConnect(true);}webScoket1.send('/getAll '+isAuthenticated);webScoket2.send('/getAll '+isAuthenticated);},100);return()=>{clearInterval(interval);};},[webScoket1,webScoket2,navigate,isAuthenticated,openNotificationWithIcon,setConnect,isServersConnected]);const handleWebSocketMessage=useCallback(newMsg=>{if(newMsg.status==='error'){openNotificationWithIcon('error','Erro',newMsg.data);return;}else if(typeof newMsg.data==='string'){return;}try{newMsg=newMsg.data;if(!selectedUser){return;}setMessages(newMsg[selectedUser]||[]);}catch(error){}},[setMessages,selectedUser,openNotificationWithIcon]);useEffect(()=>{if(webScoket1.receivedMessages){handleWebSocketMessage(webScoket1.receivedMessages);}},[webScoket1.receivedMessages,handleWebSocketMessage]);useEffect(()=>{if(webScoket2.receivedMessages){handleWebSocketMessage(webScoket2.receivedMessages);}},[webScoket2.receivedMessages,handleWebSocketMessage]);// const message = watch(\"message\", \"\");\n// Formata o timestamp da mensagem\nconst formatTimestamp=(timestamp,prevTimestamp)=>{const date=parseISO(timestamp);let formattedDate='';if(isToday(date)){formattedDate=format(date,'HH:mm');}else if(isYesterday(date)){if(!prevTimestamp||!isYesterday(parseISO(prevTimestamp))){formattedDate='Ontem '+format(date,'HH:mm');}else{formattedDate=format(date,'HH:mm');}}else{if(!prevTimestamp||format(parseISO(prevTimestamp),'yyyy-MM-dd')!==format(date,'yyyy-MM-dd')){formattedDate=format(date,'dd/MM/yyyy HH:mm');}else{formattedDate=format(date,'HH:mm');}}return formattedDate;};// Rola para o final do contêiner de mensagens\nconst scrollToBottom=()=>{if(messagesEndRef.current){messagesEndRef.current.scrollIntoView({behavior:'smooth'});}};useEffect(()=>{var _messagesEndRef$curre;// Verifica a posição de rolagem ao montar o componente\nconst container=(_messagesEndRef$curre=messagesEndRef.current)===null||_messagesEndRef$curre===void 0?void 0:_messagesEndRef$curre.parentElement;if(container){const handleScroll=()=>{if(container.scrollTop+container.clientHeight<container.scrollHeight-20){setIsScrolledUp(true);}else{setIsScrolledUp(false);}};container.addEventListener('scroll',handleScroll);return()=>container.removeEventListener('scroll',handleScroll);}},[messagesEndRef]);useEffect(()=>{if(!isScrolledUp){scrollToBottom();}},[messages,isScrolledUp]);// Conta caracteres visíveis removendo emojis\nconst countVisibleCharacters=str=>{const regex=emojiRegex();return str.replace(regex,'').length;};// Adiciona emoji ao campo de mensagem\nconst handleEmojiClick=emoji=>{setValue('msgToSend',msgToSend+emoji.emoji);setShowEmojiPicker(false);};return/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col w-3/4 bg-gray-100\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 p-4 overflow-auto\",children:[messages&&messages.map((message,id)=>/*#__PURE__*/_jsxs(Row,{children:[message.sender===isAuthenticated&&/*#__PURE__*/_jsx(\"div\",{className:\"w-3/4\"}),/*#__PURE__*/_jsxs(Col,{className:\"mb-2 p-2 rounded-lg w-1/4 \".concat(message.sender===isAuthenticated?'bg-primary text-white self-end':'bg-white self-start'),children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-600\",children:message.sender}),/*#__PURE__*/_jsx(\"div\",{className:\"text-md\",children:message.message}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500\",children:formatTimestamp(message.timestamp,id>0?messages[id-1].timestamp||'':'')})]})]},id)),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]}),/*#__PURE__*/_jsxs(\"form\",{className:\"p-4 bg-white\",onSubmit:handleSubmit(handleSendMessage),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setShowEmojiPicker(!showEmojiPicker),className:\"px-2 py-1 bg-gray-200 rounded-lg hover:bg-gray-300 focus:outline-none\",children:\"\\uD83D\\uDE0A\"}),showEmojiPicker&&/*#__PURE__*/_jsxs(\"div\",{className:\"absolute z-10 bottom-5\",children:[\" \",/*#__PURE__*/_jsx(EmojiPicker,{onEmojiClick:handleEmojiClick})]}),/*#__PURE__*/_jsx(Controller,{name:\"msgToSend\",control:control,defaultValue:\"\",render:_ref2=>{let{field}=_ref2;return/*#__PURE__*/_jsx(\"input\",{...field,className:\"flex-1 px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary\",placeholder:\"Digite sua mensagem\",maxLength:85});}}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"px-4 py-2 bg-primary text-white rounded-lg hover:bg-green-500 focus:outline-none focus:ring-2 focus:ring-primary\",children:\"Enviar\"})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600 mt-2\",children:[countVisibleCharacters(msgToSend),\"/85 caracteres\"]})]})]});};export default ChatArea;","map":{"version":3,"names":["format","isToday","isYesterday","parseISO","React","useCallback","useEffect","useRef","useState","useAuth","Controller","useForm","useWebSocket","Col","Row","emojiRegex","EmojiPicker","useNavigate","jsx","_jsx","jsxs","_jsxs","ChatArea","_ref","selectedUser","api","isAuthenticated","isServersConnected","setConnect","control","handleSubmit","reset","watch","setValue","navigate","messages","setMessages","webScoket1","process","env","REACT_APP_API_URL1","webScoket2","REACT_APP_API_URL2","messagesEndRef","isScrolledUp","setIsScrolledUp","showEmojiPicker","setShowEmojiPicker","msgToSend","handleSendMessage","data","maxLength","message","slice","checkConnection","connectWebSocket","send","concat","openNotificationWithIcon","type","description","interval","setInterval","clearInterval","handleWebSocketMessage","newMsg","status","error","receivedMessages","formatTimestamp","timestamp","prevTimestamp","date","formattedDate","scrollToBottom","current","scrollIntoView","behavior","_messagesEndRef$curre","container","parentElement","handleScroll","scrollTop","clientHeight","scrollHeight","addEventListener","removeEventListener","countVisibleCharacters","str","regex","replace","length","handleEmojiClick","emoji","className","children","map","id","sender","ref","onSubmit","onClick","onEmojiClick","name","defaultValue","render","_ref2","field","placeholder"],"sources":["/home/eduardo/repos/chat/chat-webapp/src/containers/ChatArea/index.tsx"],"sourcesContent":["import { format, isToday, isYesterday, parseISO, set } from 'date-fns';\nimport React, { useCallback, useEffect, useRef, useState } from 'react';\nimport { useAuth } from '../../contexts/AuthContext';\nimport { Controller, useForm } from 'react-hook-form';\nimport useWebSocket from '../../api';\nimport { Col, Row } from 'antd';\nimport emojiRegex from 'emoji-regex';\nimport EmojiPicker from 'emoji-picker-react';\nimport { useNavigate } from 'react-router-dom';\nimport { NotificationType } from '../../common/notificationType';\nimport { NotificationInstance } from 'antd/es/notification/interface';\n\ninterface ChatAreaProps {\n  selectedUser: string;\n  api: NotificationInstance;\n}\ninterface Messages {\n  [key: string]: Message[];\n}\ninterface Message {\n  sender: string;\n  message: string;\n  timestamp: string;\n}\n\nconst ChatArea: React.FC<ChatAreaProps> = ({ selectedUser, api }) => {\n  const { isAuthenticated, isServersConnected, setConnect } = useAuth();\n  const { control, handleSubmit, reset, watch, setValue } = useForm<{ msgToSend: string }>();\n  const navigate = useNavigate();\n  const [messages, setMessages] = useState<Message[]>([]);\n  const webScoket1= useWebSocket( process.env.REACT_APP_API_URL1 as string);\n  const webScoket2 = useWebSocket( process.env.REACT_APP_API_URL2 as string);\n\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n  const [isScrolledUp, setIsScrolledUp] = useState(false);\n  const [showEmojiPicker, setShowEmojiPicker] = useState(false);\n\n  const msgToSend = watch(\"msgToSend\", \"\");\n\n  // Limita o tamanho da mensagem e envia\n  const handleSendMessage = (data: { msgToSend: string }) => {\n    const maxLength = 85;\n    const message = data.msgToSend.slice(0, maxLength); // Limita o tamanho da mensagem\n\n    if (!message) return;\n    if (!webScoket1.checkConnection()){\n      webScoket1.connectWebSocket();\n    }\n    if (!webScoket2.checkConnection()){\n      webScoket2.connectWebSocket();\n    }\n\n    if (!webScoket1.checkConnection() && !webScoket2.checkConnection() && isServersConnected) {\n      setConnect(false);\n    } else if ((webScoket1.checkConnection() || webScoket2.checkConnection()) && !isServersConnected) {\n      setConnect(true)\n    }\n    webScoket1.send(`/sendMessage ${isAuthenticated} ${selectedUser} ${message}`);\n    webScoket2.send(`/sendMessage ${isAuthenticated} ${selectedUser} ${message}`);\n    reset();\n  };\n\n  const openNotificationWithIcon = useCallback(\n    (type: NotificationType, message: string, description: string) => {\n      api[type]({\n        message,\n        description,\n      });\n    },\n    [api]\n  );\n\n  useEffect(() => {\n    const interval = setInterval(() => {\n      if (!isAuthenticated) {\n        navigate('/');\n      }\n      if (!webScoket1.checkConnection()){\n        webScoket1.connectWebSocket();\n      }\n      if (!webScoket2.checkConnection()){\n        webScoket2.connectWebSocket();\n      }\n\n      if (!webScoket1.checkConnection() && !webScoket2.checkConnection() && isServersConnected) {\n        setConnect(false);\n      } else if ((webScoket1.checkConnection() || webScoket2.checkConnection()) && !isServersConnected) {\n        setConnect(true)\n      }\n      webScoket1.send('/getAll ' + isAuthenticated);\n      webScoket2.send('/getAll ' + isAuthenticated);\n    }, 100);\n\n    return () => {\n      clearInterval(interval);\n    };\n  }, [webScoket1, webScoket2, navigate, isAuthenticated, openNotificationWithIcon, setConnect, isServersConnected]);\n\n  \n\n  const handleWebSocketMessage = useCallback(\n    (newMsg: any) => {\n      if (newMsg.status === 'error') {\n        openNotificationWithIcon('error', 'Erro', newMsg.data);\n        return;\n      } else if (typeof newMsg.data === 'string') {\n        return;\n      }\n\n      try {\n        newMsg = newMsg.data as Messages;\n        if (!selectedUser) {\n          return;\n        }\n        \n        setMessages(newMsg[selectedUser] || []);\n      } catch (error) {\n      }\n    },\n    [setMessages, selectedUser, openNotificationWithIcon]\n  );\n\n  useEffect(() => {\n    if (webScoket1.receivedMessages) {\n      handleWebSocketMessage(webScoket1.receivedMessages);\n    }\n  }, [webScoket1.receivedMessages, handleWebSocketMessage]);\n\n  useEffect(() => {\n    if (webScoket2.receivedMessages) {\n      handleWebSocketMessage(webScoket2.receivedMessages);\n    }\n  }, [webScoket2.receivedMessages, handleWebSocketMessage]);\n\n  \n\n  // const message = watch(\"message\", \"\");\n\n  // Formata o timestamp da mensagem\n  const formatTimestamp = (timestamp: string, prevTimestamp: string) => {\n    const date = parseISO(timestamp);\n    let formattedDate = '';\n\n    if (isToday(date)) {\n      formattedDate = format(date, 'HH:mm');\n    } else if (isYesterday(date)) {\n      if (!prevTimestamp || !isYesterday(parseISO(prevTimestamp))) {\n        formattedDate = 'Ontem ' + format(date, 'HH:mm');\n      } else {\n        formattedDate = format(date, 'HH:mm');\n      }\n    } else {\n      if (!prevTimestamp || format(parseISO(prevTimestamp), 'yyyy-MM-dd') !== format(date, 'yyyy-MM-dd')) {\n        formattedDate = format(date, 'dd/MM/yyyy HH:mm');\n      } else {\n        formattedDate = format(date, 'HH:mm');\n      }\n    }\n\n    return formattedDate;\n  };\n\n  // Rola para o final do contêiner de mensagens\n  const scrollToBottom = () => {\n    if (messagesEndRef.current) {\n      messagesEndRef.current.scrollIntoView({ behavior: 'smooth' });\n    }\n  };\n\n  useEffect(() => {\n    // Verifica a posição de rolagem ao montar o componente\n    const container = messagesEndRef.current?.parentElement;\n    if (container) {\n      const handleScroll = () => {\n        if (container.scrollTop + container.clientHeight < container.scrollHeight - 20) {\n          setIsScrolledUp(true);\n        } else {\n          setIsScrolledUp(false);\n        }\n      };\n\n      container.addEventListener('scroll', handleScroll);\n      return () => container.removeEventListener('scroll', handleScroll);\n    }\n  }, [messagesEndRef]);\n\n  useEffect(() => {\n    if (!isScrolledUp) {\n      scrollToBottom();\n    }\n  }, [messages, isScrolledUp]);\n\n  // Conta caracteres visíveis removendo emojis\n  const countVisibleCharacters = (str: string) => {\n    const regex = emojiRegex();\n    return str.replace(regex, '').length;\n  };\n\n  // Adiciona emoji ao campo de mensagem\n  const handleEmojiClick = (emoji: any) => {\n    setValue('msgToSend', msgToSend + emoji.emoji);\n    setShowEmojiPicker(false);\n  };\n\n  return (\n    <div className=\"flex flex-col w-3/4 bg-gray-100\">\n      <div className=\"flex-1 p-4 overflow-auto\">\n        {messages && messages.map((message, id) => (\n          <Row key={id}>\n            {message.sender === isAuthenticated && <div className='w-3/4'></div>}\n            <Col\n              className={`mb-2 p-2 rounded-lg w-1/4 ${message.sender === isAuthenticated ? 'bg-primary text-white self-end' : 'bg-white self-start'}`}\n            >\n              <div className=\"text-sm text-gray-600\">{message.sender}</div>\n              <div className=\"text-md\">{message.message}</div>\n              <div className=\"text-xs text-gray-500\">\n                {formatTimestamp(message.timestamp, id > 0 ? messages[id - 1].timestamp || '' : '')}\n              </div>\n            </Col>\n          </Row>\n        ))}\n\n        {/* Referência para o final do contêiner de mensagens */}\n        <div ref={messagesEndRef} />\n      </div>\n      <form className=\"p-4 bg-white\" onSubmit={handleSubmit(handleSendMessage)}>\n        <div className=\"flex items-center space-x-4\">\n          <button\n            type=\"button\"\n            onClick={() => setShowEmojiPicker(!showEmojiPicker)}\n            className=\"px-2 py-1 bg-gray-200 rounded-lg hover:bg-gray-300 focus:outline-none\"\n          >\n            😊\n          </button>\n          {showEmojiPicker && (\n            <div className=\"absolute z-10 bottom-5\"> {/* Wrapper para posicionar o Emoji Picker */}\n              <EmojiPicker onEmojiClick={handleEmojiClick} />\n            </div>\n          )}\n          <Controller\n            name=\"msgToSend\"\n            control={control}\n            defaultValue=\"\"\n            render={({ field }) => (\n              <input\n                {...field}\n                className=\"flex-1 px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary\"\n                placeholder=\"Digite sua mensagem\"\n                maxLength={85}\n              />\n            )}\n          />\n          <button\n            type=\"submit\"\n            className=\"px-4 py-2 bg-primary text-white rounded-lg hover:bg-green-500 focus:outline-none focus:ring-2 focus:ring-primary\"\n          >\n            Enviar\n          </button>\n        </div>\n        <p className=\"text-sm text-gray-600 mt-2\">{countVisibleCharacters(msgToSend)}/85 caracteres</p>\n      </form>\n    </div>\n  );\n};\n\nexport default ChatArea;\n"],"mappings":"AAAA,OAASA,MAAM,CAAEC,OAAO,CAAEC,WAAW,CAAEC,QAAQ,KAAa,UAAU,CACtE,MAAO,CAAAC,KAAK,EAAIC,WAAW,CAAEC,SAAS,CAAEC,MAAM,CAAEC,QAAQ,KAAQ,OAAO,CACvE,OAASC,OAAO,KAAQ,4BAA4B,CACpD,OAASC,UAAU,CAAEC,OAAO,KAAQ,iBAAiB,CACrD,MAAO,CAAAC,YAAY,KAAM,WAAW,CACpC,OAASC,GAAG,CAAEC,GAAG,KAAQ,MAAM,CAC/B,MAAO,CAAAC,UAAU,KAAM,aAAa,CACpC,MAAO,CAAAC,WAAW,KAAM,oBAAoB,CAC5C,OAASC,WAAW,KAAQ,kBAAkB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAiB/C,KAAM,CAAAC,QAAiC,CAAGC,IAAA,EAA2B,IAA1B,CAAEC,YAAY,CAAEC,GAAI,CAAC,CAAAF,IAAA,CAC9D,KAAM,CAAEG,eAAe,CAAEC,kBAAkB,CAAEC,UAAW,CAAC,CAAGnB,OAAO,CAAC,CAAC,CACrE,KAAM,CAAEoB,OAAO,CAAEC,YAAY,CAAEC,KAAK,CAAEC,KAAK,CAAEC,QAAS,CAAC,CAAGtB,OAAO,CAAwB,CAAC,CAC1F,KAAM,CAAAuB,QAAQ,CAAGjB,WAAW,CAAC,CAAC,CAC9B,KAAM,CAACkB,QAAQ,CAAEC,WAAW,CAAC,CAAG5B,QAAQ,CAAY,EAAE,CAAC,CACvD,KAAM,CAAA6B,UAAU,CAAEzB,YAAY,CAAE0B,OAAO,CAACC,GAAG,CAACC,kBAA4B,CAAC,CACzE,KAAM,CAAAC,UAAU,CAAG7B,YAAY,CAAE0B,OAAO,CAACC,GAAG,CAACG,kBAA4B,CAAC,CAE1E,KAAM,CAAAC,cAAc,CAAGpC,MAAM,CAAiB,IAAI,CAAC,CACnD,KAAM,CAACqC,YAAY,CAAEC,eAAe,CAAC,CAAGrC,QAAQ,CAAC,KAAK,CAAC,CACvD,KAAM,CAACsC,eAAe,CAAEC,kBAAkB,CAAC,CAAGvC,QAAQ,CAAC,KAAK,CAAC,CAE7D,KAAM,CAAAwC,SAAS,CAAGhB,KAAK,CAAC,WAAW,CAAE,EAAE,CAAC,CAExC;AACA,KAAM,CAAAiB,iBAAiB,CAAIC,IAA2B,EAAK,CACzD,KAAM,CAAAC,SAAS,CAAG,EAAE,CACpB,KAAM,CAAAC,OAAO,CAAGF,IAAI,CAACF,SAAS,CAACK,KAAK,CAAC,CAAC,CAAEF,SAAS,CAAC,CAAE;AAEpD,GAAI,CAACC,OAAO,CAAE,OACd,GAAI,CAACf,UAAU,CAACiB,eAAe,CAAC,CAAC,CAAC,CAChCjB,UAAU,CAACkB,gBAAgB,CAAC,CAAC,CAC/B,CACA,GAAI,CAACd,UAAU,CAACa,eAAe,CAAC,CAAC,CAAC,CAChCb,UAAU,CAACc,gBAAgB,CAAC,CAAC,CAC/B,CAEA,GAAI,CAAClB,UAAU,CAACiB,eAAe,CAAC,CAAC,EAAI,CAACb,UAAU,CAACa,eAAe,CAAC,CAAC,EAAI3B,kBAAkB,CAAE,CACxFC,UAAU,CAAC,KAAK,CAAC,CACnB,CAAC,IAAM,IAAI,CAACS,UAAU,CAACiB,eAAe,CAAC,CAAC,EAAIb,UAAU,CAACa,eAAe,CAAC,CAAC,GAAK,CAAC3B,kBAAkB,CAAE,CAChGC,UAAU,CAAC,IAAI,CAAC,CAClB,CACAS,UAAU,CAACmB,IAAI,iBAAAC,MAAA,CAAiB/B,eAAe,MAAA+B,MAAA,CAAIjC,YAAY,MAAAiC,MAAA,CAAIL,OAAO,CAAE,CAAC,CAC7EX,UAAU,CAACe,IAAI,iBAAAC,MAAA,CAAiB/B,eAAe,MAAA+B,MAAA,CAAIjC,YAAY,MAAAiC,MAAA,CAAIL,OAAO,CAAE,CAAC,CAC7ErB,KAAK,CAAC,CAAC,CACT,CAAC,CAED,KAAM,CAAA2B,wBAAwB,CAAGrD,WAAW,CAC1C,CAACsD,IAAsB,CAAEP,OAAe,CAAEQ,WAAmB,GAAK,CAChEnC,GAAG,CAACkC,IAAI,CAAC,CAAC,CACRP,OAAO,CACPQ,WACF,CAAC,CAAC,CACJ,CAAC,CACD,CAACnC,GAAG,CACN,CAAC,CAEDnB,SAAS,CAAC,IAAM,CACd,KAAM,CAAAuD,QAAQ,CAAGC,WAAW,CAAC,IAAM,CACjC,GAAI,CAACpC,eAAe,CAAE,CACpBQ,QAAQ,CAAC,GAAG,CAAC,CACf,CACA,GAAI,CAACG,UAAU,CAACiB,eAAe,CAAC,CAAC,CAAC,CAChCjB,UAAU,CAACkB,gBAAgB,CAAC,CAAC,CAC/B,CACA,GAAI,CAACd,UAAU,CAACa,eAAe,CAAC,CAAC,CAAC,CAChCb,UAAU,CAACc,gBAAgB,CAAC,CAAC,CAC/B,CAEA,GAAI,CAAClB,UAAU,CAACiB,eAAe,CAAC,CAAC,EAAI,CAACb,UAAU,CAACa,eAAe,CAAC,CAAC,EAAI3B,kBAAkB,CAAE,CACxFC,UAAU,CAAC,KAAK,CAAC,CACnB,CAAC,IAAM,IAAI,CAACS,UAAU,CAACiB,eAAe,CAAC,CAAC,EAAIb,UAAU,CAACa,eAAe,CAAC,CAAC,GAAK,CAAC3B,kBAAkB,CAAE,CAChGC,UAAU,CAAC,IAAI,CAAC,CAClB,CACAS,UAAU,CAACmB,IAAI,CAAC,UAAU,CAAG9B,eAAe,CAAC,CAC7Ce,UAAU,CAACe,IAAI,CAAC,UAAU,CAAG9B,eAAe,CAAC,CAC/C,CAAC,CAAE,GAAG,CAAC,CAEP,MAAO,IAAM,CACXqC,aAAa,CAACF,QAAQ,CAAC,CACzB,CAAC,CACH,CAAC,CAAE,CAACxB,UAAU,CAAEI,UAAU,CAAEP,QAAQ,CAAER,eAAe,CAAEgC,wBAAwB,CAAE9B,UAAU,CAAED,kBAAkB,CAAC,CAAC,CAIjH,KAAM,CAAAqC,sBAAsB,CAAG3D,WAAW,CACvC4D,MAAW,EAAK,CACf,GAAIA,MAAM,CAACC,MAAM,GAAK,OAAO,CAAE,CAC7BR,wBAAwB,CAAC,OAAO,CAAE,MAAM,CAAEO,MAAM,CAACf,IAAI,CAAC,CACtD,OACF,CAAC,IAAM,IAAI,MAAO,CAAAe,MAAM,CAACf,IAAI,GAAK,QAAQ,CAAE,CAC1C,OACF,CAEA,GAAI,CACFe,MAAM,CAAGA,MAAM,CAACf,IAAgB,CAChC,GAAI,CAAC1B,YAAY,CAAE,CACjB,OACF,CAEAY,WAAW,CAAC6B,MAAM,CAACzC,YAAY,CAAC,EAAI,EAAE,CAAC,CACzC,CAAE,MAAO2C,KAAK,CAAE,CAChB,CACF,CAAC,CACD,CAAC/B,WAAW,CAAEZ,YAAY,CAAEkC,wBAAwB,CACtD,CAAC,CAEDpD,SAAS,CAAC,IAAM,CACd,GAAI+B,UAAU,CAAC+B,gBAAgB,CAAE,CAC/BJ,sBAAsB,CAAC3B,UAAU,CAAC+B,gBAAgB,CAAC,CACrD,CACF,CAAC,CAAE,CAAC/B,UAAU,CAAC+B,gBAAgB,CAAEJ,sBAAsB,CAAC,CAAC,CAEzD1D,SAAS,CAAC,IAAM,CACd,GAAImC,UAAU,CAAC2B,gBAAgB,CAAE,CAC/BJ,sBAAsB,CAACvB,UAAU,CAAC2B,gBAAgB,CAAC,CACrD,CACF,CAAC,CAAE,CAAC3B,UAAU,CAAC2B,gBAAgB,CAAEJ,sBAAsB,CAAC,CAAC,CAIzD;AAEA;AACA,KAAM,CAAAK,eAAe,CAAGA,CAACC,SAAiB,CAAEC,aAAqB,GAAK,CACpE,KAAM,CAAAC,IAAI,CAAGrE,QAAQ,CAACmE,SAAS,CAAC,CAChC,GAAI,CAAAG,aAAa,CAAG,EAAE,CAEtB,GAAIxE,OAAO,CAACuE,IAAI,CAAC,CAAE,CACjBC,aAAa,CAAGzE,MAAM,CAACwE,IAAI,CAAE,OAAO,CAAC,CACvC,CAAC,IAAM,IAAItE,WAAW,CAACsE,IAAI,CAAC,CAAE,CAC5B,GAAI,CAACD,aAAa,EAAI,CAACrE,WAAW,CAACC,QAAQ,CAACoE,aAAa,CAAC,CAAC,CAAE,CAC3DE,aAAa,CAAG,QAAQ,CAAGzE,MAAM,CAACwE,IAAI,CAAE,OAAO,CAAC,CAClD,CAAC,IAAM,CACLC,aAAa,CAAGzE,MAAM,CAACwE,IAAI,CAAE,OAAO,CAAC,CACvC,CACF,CAAC,IAAM,CACL,GAAI,CAACD,aAAa,EAAIvE,MAAM,CAACG,QAAQ,CAACoE,aAAa,CAAC,CAAE,YAAY,CAAC,GAAKvE,MAAM,CAACwE,IAAI,CAAE,YAAY,CAAC,CAAE,CAClGC,aAAa,CAAGzE,MAAM,CAACwE,IAAI,CAAE,kBAAkB,CAAC,CAClD,CAAC,IAAM,CACLC,aAAa,CAAGzE,MAAM,CAACwE,IAAI,CAAE,OAAO,CAAC,CACvC,CACF,CAEA,MAAO,CAAAC,aAAa,CACtB,CAAC,CAED;AACA,KAAM,CAAAC,cAAc,CAAGA,CAAA,GAAM,CAC3B,GAAI/B,cAAc,CAACgC,OAAO,CAAE,CAC1BhC,cAAc,CAACgC,OAAO,CAACC,cAAc,CAAC,CAAEC,QAAQ,CAAE,QAAS,CAAC,CAAC,CAC/D,CACF,CAAC,CAEDvE,SAAS,CAAC,IAAM,KAAAwE,qBAAA,CACd;AACA,KAAM,CAAAC,SAAS,EAAAD,qBAAA,CAAGnC,cAAc,CAACgC,OAAO,UAAAG,qBAAA,iBAAtBA,qBAAA,CAAwBE,aAAa,CACvD,GAAID,SAAS,CAAE,CACb,KAAM,CAAAE,YAAY,CAAGA,CAAA,GAAM,CACzB,GAAIF,SAAS,CAACG,SAAS,CAAGH,SAAS,CAACI,YAAY,CAAGJ,SAAS,CAACK,YAAY,CAAG,EAAE,CAAE,CAC9EvC,eAAe,CAAC,IAAI,CAAC,CACvB,CAAC,IAAM,CACLA,eAAe,CAAC,KAAK,CAAC,CACxB,CACF,CAAC,CAEDkC,SAAS,CAACM,gBAAgB,CAAC,QAAQ,CAAEJ,YAAY,CAAC,CAClD,MAAO,IAAMF,SAAS,CAACO,mBAAmB,CAAC,QAAQ,CAAEL,YAAY,CAAC,CACpE,CACF,CAAC,CAAE,CAACtC,cAAc,CAAC,CAAC,CAEpBrC,SAAS,CAAC,IAAM,CACd,GAAI,CAACsC,YAAY,CAAE,CACjB8B,cAAc,CAAC,CAAC,CAClB,CACF,CAAC,CAAE,CAACvC,QAAQ,CAAES,YAAY,CAAC,CAAC,CAE5B;AACA,KAAM,CAAA2C,sBAAsB,CAAIC,GAAW,EAAK,CAC9C,KAAM,CAAAC,KAAK,CAAG1E,UAAU,CAAC,CAAC,CAC1B,MAAO,CAAAyE,GAAG,CAACE,OAAO,CAACD,KAAK,CAAE,EAAE,CAAC,CAACE,MAAM,CACtC,CAAC,CAED;AACA,KAAM,CAAAC,gBAAgB,CAAIC,KAAU,EAAK,CACvC5D,QAAQ,CAAC,WAAW,CAAEe,SAAS,CAAG6C,KAAK,CAACA,KAAK,CAAC,CAC9C9C,kBAAkB,CAAC,KAAK,CAAC,CAC3B,CAAC,CAED,mBACE1B,KAAA,QAAKyE,SAAS,CAAC,iCAAiC,CAAAC,QAAA,eAC9C1E,KAAA,QAAKyE,SAAS,CAAC,0BAA0B,CAAAC,QAAA,EACtC5D,QAAQ,EAAIA,QAAQ,CAAC6D,GAAG,CAAC,CAAC5C,OAAO,CAAE6C,EAAE,gBACpC5E,KAAA,CAACP,GAAG,EAAAiF,QAAA,EACD3C,OAAO,CAAC8C,MAAM,GAAKxE,eAAe,eAAIP,IAAA,QAAK2E,SAAS,CAAC,OAAO,CAAM,CAAC,cACpEzE,KAAA,CAACR,GAAG,EACFiF,SAAS,8BAAArC,MAAA,CAA+BL,OAAO,CAAC8C,MAAM,GAAKxE,eAAe,CAAG,gCAAgC,CAAG,qBAAqB,CAAG,CAAAqE,QAAA,eAExI5E,IAAA,QAAK2E,SAAS,CAAC,uBAAuB,CAAAC,QAAA,CAAE3C,OAAO,CAAC8C,MAAM,CAAM,CAAC,cAC7D/E,IAAA,QAAK2E,SAAS,CAAC,SAAS,CAAAC,QAAA,CAAE3C,OAAO,CAACA,OAAO,CAAM,CAAC,cAChDjC,IAAA,QAAK2E,SAAS,CAAC,uBAAuB,CAAAC,QAAA,CACnC1B,eAAe,CAACjB,OAAO,CAACkB,SAAS,CAAE2B,EAAE,CAAG,CAAC,CAAG9D,QAAQ,CAAC8D,EAAE,CAAG,CAAC,CAAC,CAAC3B,SAAS,EAAI,EAAE,CAAG,EAAE,CAAC,CAChF,CAAC,EACH,CAAC,GAVE2B,EAWL,CACN,CAAC,cAGF9E,IAAA,QAAKgF,GAAG,CAAExD,cAAe,CAAE,CAAC,EACzB,CAAC,cACNtB,KAAA,SAAMyE,SAAS,CAAC,cAAc,CAACM,QAAQ,CAAEtE,YAAY,CAACmB,iBAAiB,CAAE,CAAA8C,QAAA,eACvE1E,KAAA,QAAKyE,SAAS,CAAC,6BAA6B,CAAAC,QAAA,eAC1C5E,IAAA,WACEwC,IAAI,CAAC,QAAQ,CACb0C,OAAO,CAAEA,CAAA,GAAMtD,kBAAkB,CAAC,CAACD,eAAe,CAAE,CACpDgD,SAAS,CAAC,uEAAuE,CAAAC,QAAA,CAClF,cAED,CAAQ,CAAC,CACRjD,eAAe,eACdzB,KAAA,QAAKyE,SAAS,CAAC,wBAAwB,CAAAC,QAAA,EAAC,GAAC,cACvC5E,IAAA,CAACH,WAAW,EAACsF,YAAY,CAAEV,gBAAiB,CAAE,CAAC,EAC5C,CACN,cACDzE,IAAA,CAACT,UAAU,EACT6F,IAAI,CAAC,WAAW,CAChB1E,OAAO,CAAEA,OAAQ,CACjB2E,YAAY,CAAC,EAAE,CACfC,MAAM,CAAEC,KAAA,MAAC,CAAEC,KAAM,CAAC,CAAAD,KAAA,oBAChBvF,IAAA,aACMwF,KAAK,CACTb,SAAS,CAAC,uFAAuF,CACjGc,WAAW,CAAC,qBAAqB,CACjCzD,SAAS,CAAE,EAAG,CACf,CAAC,EACF,CACH,CAAC,cACFhC,IAAA,WACEwC,IAAI,CAAC,QAAQ,CACbmC,SAAS,CAAC,kHAAkH,CAAAC,QAAA,CAC7H,QAED,CAAQ,CAAC,EACN,CAAC,cACN1E,KAAA,MAAGyE,SAAS,CAAC,4BAA4B,CAAAC,QAAA,EAAER,sBAAsB,CAACvC,SAAS,CAAC,CAAC,gBAAc,EAAG,CAAC,EAC3F,CAAC,EACJ,CAAC,CAEV,CAAC,CAED,cAAe,CAAA1B,QAAQ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}