{"ast":null,"code":"import React,{useCallback,useEffect,useRef}from'react';import{useNavigate}from'react-router-dom';import{FiLogOut,FiUser}from'react-icons/fi';// Importando o ícone de logout e o ícone de usuário\nimport useWebSocket from'../../api';import{useAuth}from'../../contexts/AuthContext';import{Button}from'antd';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Sidebar=_ref=>{let{friends,newMessageFriend,setSelectedUser,selectedUser,openNotificationWithIcon}=_ref;const navigate=useNavigate();const webScoket1=useWebSocket(process.env.REACT_APP_API_URL1);const webScoket2=useWebSocket(process.env.REACT_APP_API_URL2);const{isAuthenticated,logout}=useAuth();const inputRef=useRef(null);const handleAddFriend=()=>{var _inputRef$current;const username=(_inputRef$current=inputRef.current)===null||_inputRef$current===void 0?void 0:_inputRef$current.value.trim();if(username){webScoket1.send(\"/addFriend \".concat(isAuthenticated,\" \").concat(username));webScoket2.send(\"/addFriend \".concat(isAuthenticated,\" \").concat(username));}else{openNotificationWithIcon('error','Erro','Digite um nome de usuário.');}};const handleChangeFriend=username=>{setSelectedUser(username);};const handleWebSocketMessage=useCallback(message=>{if(message.status==='success'){if(inputRef.current)inputRef.current.value='';openNotificationWithIcon('success','Amigo Adicionado','Amigo adicionado com sucesso!');}else if(message.status==='error'){openNotificationWithIcon('error','Erro',message.data);}},[openNotificationWithIcon]);useEffect(()=>{if(webScoket1.receivedMessages){handleWebSocketMessage(webScoket1.receivedMessages);}},[webScoket1.receivedMessages,handleWebSocketMessage]);useEffect(()=>{if(webScoket2.receivedMessages){handleWebSocketMessage(webScoket2.receivedMessages);}},[webScoket2.receivedMessages,handleWebSocketMessage]);return/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col h-full bg-lightGray p-4 w-1/4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-grow\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center mb-4\",children:[/*#__PURE__*/_jsx(FiUser,{className:\"text-2xl mr-2\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xl\",children:isAuthenticated})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold\",children:\"Amigos\"}),/*#__PURE__*/_jsx(FiLogOut,{className:\"text-2xl cursor-pointer\",onClick:()=>{logout();navigate('/');// Navegar para a página de login após o logout\n}})]}),/*#__PURE__*/_jsx(\"ul\",{className:\"space-y-2\",children:!!friends&&friends.map(friend=>/*#__PURE__*/_jsx(Button,{className:\"w-full text-left \".concat(selectedUser===friend?'bg-primary text-white':newMessageFriend.includes(friend)?'bg-yellow-300':'bg-white'),onClick:()=>handleChangeFriend(friend),children:friend}))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Nome do amigo\",className:\"w-full px-4 py-2 bg-white rounded-lg shadow mb-2\",onKeyDown:e=>{if(e.key==='Enter')handleAddFriend();},ref:inputRef}),/*#__PURE__*/_jsx(\"button\",{className:\"w-full px-4 py-2 bg-primary text-white rounded-lg hover:bg-green-500 focus:outline-none focus:ring-2 focus:ring-primary\",onClick:handleAddFriend,children:\"Adicionar Amigo\"})]})]});};export default Sidebar;","map":{"version":3,"names":["React","useCallback","useEffect","useRef","useNavigate","FiLogOut","FiUser","useWebSocket","useAuth","Button","jsx","_jsx","jsxs","_jsxs","Sidebar","_ref","friends","newMessageFriend","setSelectedUser","selectedUser","openNotificationWithIcon","navigate","webScoket1","process","env","REACT_APP_API_URL1","webScoket2","REACT_APP_API_URL2","isAuthenticated","logout","inputRef","handleAddFriend","_inputRef$current","username","current","value","trim","send","concat","handleChangeFriend","handleWebSocketMessage","message","status","data","receivedMessages","className","children","onClick","map","friend","includes","type","placeholder","onKeyDown","e","key","ref"],"sources":["/home/eduardo/repos/chat/chat-webapp/src/containers/SideBar/index.tsx"],"sourcesContent":["import React, { useCallback, useEffect, useRef } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { FiLogOut, FiUser } from 'react-icons/fi'; // Importando o ícone de logout e o ícone de usuário\nimport { NotificationType } from '../../common/notificationType';\nimport useWebSocket from '../../api';\nimport { useAuth } from '../../contexts/AuthContext';\nimport { Button } from 'antd';\n\ninterface SidebarProps {\n  friends: string[] | undefined;\n  newMessageFriend: string[];\n  setSelectedUser: (username: string) => void;\n  selectedUser: string | null;\n  openNotificationWithIcon: (type: NotificationType, message: string, description: string) => void;\n}\n\nconst Sidebar: React.FC<SidebarProps> = ({ friends, newMessageFriend, setSelectedUser, selectedUser, openNotificationWithIcon }) => {\n  const navigate = useNavigate();\n  const webScoket1= useWebSocket( process.env.REACT_APP_API_URL1 as string);\n  const webScoket2 = useWebSocket( process.env.REACT_APP_API_URL2 as string);\n  const { isAuthenticated, logout } = useAuth();\n\n  const inputRef = useRef<HTMLInputElement>(null);\n\n  const handleAddFriend = () => {\n    const username = inputRef.current?.value.trim();\n      if (username) {\n        webScoket1.send(`/addFriend ${isAuthenticated} ${username}`);\n        webScoket2.send(`/addFriend ${isAuthenticated} ${username}`);\n      } else { \n        openNotificationWithIcon('error', 'Erro', 'Digite um nome de usuário.');\n      }\n  };\n\n  const handleChangeFriend = (username: string) => {\n    setSelectedUser(username);\n  }\n\n  const handleWebSocketMessage = useCallback(\n    (message: any) => {\n      if (message.status === 'success') {\n        if (inputRef.current)\n          inputRef.current.value = '';\n        openNotificationWithIcon('success', 'Amigo Adicionado', 'Amigo adicionado com sucesso!');\n      } else if (message.status === 'error') {\n        openNotificationWithIcon('error', 'Erro', message.data);\n      }\n    },\n    [openNotificationWithIcon]\n  );\n\n  useEffect(() => {\n    if (webScoket1.receivedMessages) {\n      handleWebSocketMessage(webScoket1.receivedMessages);\n    }\n  }, [webScoket1.receivedMessages, handleWebSocketMessage]);\n\n  useEffect(() => {\n    if (webScoket2.receivedMessages) {\n      handleWebSocketMessage(webScoket2.receivedMessages);\n    }\n  }, [webScoket2.receivedMessages, handleWebSocketMessage]);\n\n  return (\n    <div className=\"flex flex-col h-full bg-lightGray p-4 w-1/4\">\n      <div className=\"flex-grow\">\n      <div className=\"flex items-center mb-4\">\n          <FiUser className=\"text-2xl mr-2\" />\n          <span className=\"text-xl\">{isAuthenticated}</span>\n        </div>\n        <div className=\"flex items-center justify-between mb-4\">\n          <h2 className=\"text-2xl font-bold\">Amigos</h2>\n          <FiLogOut\n            className=\"text-2xl cursor-pointer\"\n            onClick={() => {\n              logout();\n              navigate('/'); // Navegar para a página de login após o logout\n            }}\n          />\n        </div>\n       \n        <ul className=\"space-y-2\">\n          {!!friends && friends.map((friend) => \n             (\n              <Button\n                className={`w-full text-left ${selectedUser === friend ? 'bg-primary text-white' : newMessageFriend.includes(friend) ? 'bg-yellow-300' : 'bg-white'}`}\n                onClick={() => handleChangeFriend(friend)}\n              >\n              {friend}\n              </Button>\n          ))}\n        </ul>\n      </div>\n      <div className=\"mt-4\">\n        <input\n          type=\"text\"\n          placeholder=\"Nome do amigo\"\n          className=\"w-full px-4 py-2 bg-white rounded-lg shadow mb-2\"\n          onKeyDown={(e) => {if (e.key === 'Enter') handleAddFriend()}}\n          ref={inputRef}\n        />\n        <button\n          className=\"w-full px-4 py-2 bg-primary text-white rounded-lg hover:bg-green-500 focus:outline-none focus:ring-2 focus:ring-primary\"\n          onClick={ handleAddFriend }\n        >\n          Adicionar Amigo\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default Sidebar;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}